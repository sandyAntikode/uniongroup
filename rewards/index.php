<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
  <head>
    <?php $prefix="../";?>
    <?php include($prefix."include/head.php"); ?>
    <?php include($prefix."include/tracking-script/head.php"); ?>
  </head>
  <body>
    <?php include($prefix."include/tracking-script/body.php"); ?>
    <?php include($prefix."include/navbar-reward.php"); ?>
    <section class="section-banner-img section-img-loyalty">
      <div class="parallax-window" data-image-src="<?php echo $prefix;?>assets/img/common/img_banner_download_app.jpg">
        <div class="section-background-color section-header-benefit">
          <div class="container">
            <div class="row py-4">
              <div class="col-lg-5 order-last order-lg-first">
                <img src="<?php echo $prefix;?>assets/img/common/mockup.png" class="img-mockup animated fadeInUp" align="Mockup App">
              </div>
              <div class="pl-0 col-md-12 col-lg-7 py-main">
                <div class="section-header-benefit-content animated fadeInUp delayp2">
                  <h3 class="text-white">U+REWARDS</h3> 
                  <p class="text-gray-100">U+REWARDS is The Union Groupâ€™s new and exclusive loyalty program. Join to start earning points and get exclusive privileges at all The Union Group establishments.</p>
                  <div class="mt-4">
                    <a href="https://itunes.apple.com/us/app/the-union-group/id1445510338?mt=8" target="_blank" class="img-download">
                      <img src="<?php echo $prefix;?>assets/img/common/button_appstore.png" target="_blank" class="mb-3" alt="Download Apps Store">
                    </a>
                    <a href="https://play.google.com/store/apps/details?id=com.uniongroup.union" target="_blank" class="img-download">
                      <img src="<?php echo $prefix;?>assets/img/common/button_playstore.png" class="mb-3" alt="Download Play Store">
                    </a>
                  </div>
                  <!-- <a href="<?php echo $prefix;?>loyalty/register/" class="font-weight-light text-white border-bottom">Register Now</a> -->
                </div>
              </div>  
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="py-5 section-img-pattern-white section-app-benefit">
      <div class="container">
        <div class="row">
          <div class="col-md-5 animated fadeInUp delayp3 mb-3">
            <div class="heading heading-border-bottom position-relative">
              <h4>What's in the app ?</h4>
            </div>
          </div>
          <div class="col-md-6 offset-md-1">
            <div class="row pr-0 pl-0 animated fadeInUp delayp4">
              <div class="col-md-6">
                <div class="section-app-benefit-col">
                  <div class="row">
                    <div class="col-3 col-md-3">
                      <img src="<?php echo $prefix;?>assets/img/common/ic_promo.png" class="img-fluid" alt="Icon Benefit App">
                    </div>
                    <div class="col-9 col-md-9">
                      <div class="heading">
                        <h5>Earn Points</h5>
                      </div>
                      <p class="font-size-md">Book a table instantly and earn U+Points when you dine</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="section-app-benefit-col">
                  <div class="row">
                    <div class="col-3 col-md-3">
                      <img src="<?php echo $prefix;?>assets/img/common/ic_reward.png" class="img-fluid" alt="Icon Benefit App">
                    </div>
                    <div class="col-9 col-md-9">
                      <div class="heading">
                        <h5>Redeem Rewards</h5>
                      </div>
                      <p class="font-size-md">Redeem points for amazing rewards</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="section-app-benefit-col">
                  <div class="row">
                    <div class="col-3 col-md-3">
                      <img src="<?php echo $prefix;?>assets/img/common/ic_account.png" class="img-fluid" alt="Icon Benefit App">
                    </div>
                    <div class="col-9 col-md-9">
                      <div class="heading">
                        <h5>Membership Level</h5>
                      </div>
                      <p class="font-size-md">Keep track of your membership level, benefits, points and transactions</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="section-app-benefit-col">
                  <div class="row">
                    <div class="col-3 col-md-3">
                      <img src="<?php echo $prefix;?>assets/img/common/ic_challenge.png" class="img-fluid" alt="Icon Benefit App">
                    </div>
                    <div class="col-9 col-md-9">
                      <div class="heading">
                        <h5>Challenge</h5>
                      </div>
                      <p class="font-size-md">Complete exciting challenges and earn bonus points</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <section class="py-5 section-img-pattern" id="member-benefits">
      <div class="container container-md">
        <div class="heading text-center vp-fadeinup">
          <h4>Member Benefits</h4>
        </div>
        <div class="section-member-benefit mt-5">
          <div class="row text-center">
            <div class="col-4 col-md-4 container-content vp-fadeinup delayp1">
              <a href="#" data-level="SILVER" class="img-medal active">
                <img src="<?php echo $prefix;?>assets/img/brand/ic_badge_Silver.png" alt="Silver Medal">
              </a>
            </div>
            <div class="col-4 col-md-4 container-content vp-fadeinup delayp2">
              <a href="#" data-level="GOLD" class="img-medal">
                <img src="<?php echo $prefix;?>assets/img/brand/ic_badge_Gold.png" alt="Silver Medal">
              </a>
            </div>
            <div class="col-4 col-md-4 container-content vp-fadeinup delayp3">
              <a href="#" data-level="BLACK" class="img-medal">
                <img src="<?php echo $prefix;?>assets/img/brand/ic_badge_Black.png" alt="Silver Medal">
              </a>
            </div>
          </div>
          <div class="text-center mt-2 vp-fadeinup">
            <div id="medal-text" class="text-uppercase"></div>
          </div>
        </div>
        <div class="mt-2 mt-md-5 vp-fadeinup" id="benefits-content">
          <div class="row">
            <div class="col-md-10 offset-md-1 col-lg-8 offset-lg-2 col-xl-6 offset-xl-3">
              <nav class="pr-l pl-2">
                <div class="nav nav-tabs text-center nav-tabs-benefit" id="nav-tab" role="tablist">
                  <a class="nav-item nav-link active bg-transparent" id="nav-level-tab" data-toggle="tab" href="#nav-level" role="tab" aria-controls="nav-level" aria-selected="true">By Level</a>
                  <a class="nav-item nav-link bg-transparent" id="nav-brands-tab" data-toggle="tab" href="#nav-brands" role="tab" aria-controls="nav-brands" aria-selected="false">By Brand</a>
                </div>
              </nav>
            </div>
            <div class="col-md-10 offset-md-1">
              <div class="tab-content pb-4 mt-0" id="nav-tabContent">
                <div class="tab-pane fade show active section-form-content" id="nav-level" role="tabpanel" aria-labelledby="nav-level-tab animated fadeInUp">
                  <div class="row" id="level-tier">
                    <!-- Content Level -->
                  </div>
                </div>
                <div class="tab-pane fade section-form-content" id="nav-brands" role="tabpanel" aria-labelledby="nav-brands-tab vp-fadeinup delayp1">
                  <div class="row" id="brand-tier">
                    <!-- Content Brand -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal -->
    <!-- Modal Vocher -->
    <div class="modal fade modal-dashboard modal-popup" id="modal-promo" tabindex="-1" role="dialog" aria-labelledby="VocherLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <div class="row">
              <div class="col-2 col-md-2 container-content pl-0 pr-0">
                <img src="<?php echo $prefix;?>assets/img/brand/ic_benefit_voucher.png" class="img-fluid" alt="img brand" id="VocherIcon">
              </div>
              <div class="col-8 col-md-7 container-content pr-0">
                <h5 class="modal-title text-white text-uppercase-custom font-weight-normal font-size-md" id="VocherLabel">
                  
                </h5>
              </div>
              <div class="col-2 col-md-3 container-content">
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                  <img src="<?php echo $prefix;?>assets/img/common/ic_close_white.png" alt="Close">
                </button>
              </div>
            </div>
          </div>
          <div class="modal-body" style="background: url('<?php echo $prefix;?>assets/img/common/img_bg_texture_white.png');">
            <div class="section-point-history mt-3 mb-2" id="modal-body-promo">
              
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Brand -->
    <div class="modal fade modal-dashboard modal-popup" id="modal-brand" tabindex="-1" role="dialog" aria-labelledby="BrandLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header pl-0 pr-0 py-0 d-block section-banner-img" style="background: url(<?php echo $prefix;?>assets/img/brand/img_banner.jpg); background-size: cover;overflow: hidden;" id="modal-brand-banner">
            <div class="section-background-color pb-0">
              <div class="heading text-center">
                <h5 class="mb-0 text-white" id="modal-brand-name"></h5>
              </div>
              <div class="brand-img text-center mt-5">
                <img src="<?php echo $prefix;?>assets/img/brand/img_logo_benedict.png" class="img-fluid" alt="img brand" id="modal-brand-logo">
              </div>
              <nav class="pr-l pl-2 mt-5">
                <div class="nav nav-tabs text-center row pr-md-5 pl-md-5 nav-tabs-benefit mb-0" id="nav-tab" role="tablist">
                  <a class="nav-item nav-link active bg-transparent col-4 button-brand-level" id="nav-silver-tab" data-toggle="tab" href="#modal-body-brand-silver" role="tab" aria-controls="nav-silver" aria-selected="true" data-level="SILVER">Silver</a>
                  <a class="nav-item nav-link bg-transparent col-4 button-brand-level" id="nav-gold-tab" data-toggle="tab" href="#modal-body-brand-gold" role="tab" aria-controls="nav-gold" aria-selected="false" data-level="GOLD">Gold</a>
                  <a class="nav-item nav-link bg-transparent col-4 button-brand-level" id="nav-black-tab" data-toggle="tab" href="#modal-body-brand-black" role="tab" aria-controls="nav-black" aria-selected="false" data-level="BLACK">Black</a>
                </div>
              </nav>
              <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                <img src="<?php echo $prefix;?>assets/img/common/ic_close_white.png" alt="Close">
              </button>
            </div>
          </div>
          <div class="modal-body section-img-pattern-white">
            <div class="tab-content pb-4 mt-4" id="nav-tabContent">
              <div class="tab-pane fade show active section-form-content pr-3 pl-3" id="modal-body-brand-silver" role="tabpanel" aria-labelledby="nav-silver-tab animated fadeInUp">
                
              </div>
              <div class="tab-pane fade show section-form-content pr-3 pl-3" id="modal-body-brand-gold" role="tabpanel" aria-labelledby="nav-gold-tab animated fadeInUp">
                
              </div>
              <div class="tab-pane fade show section-form-content pr-3 pl-3" id="modal-body-brand-black" role="tabpanel" aria-labelledby="nav-black-tab animated fadeInUp">
                
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <style>
      .point-history-img-merchant {
        width: 20%;
      }
      .point-history-inner {
        width: 70%;
      }
      .modal-dashboard .nav-tabs .nav-link:hover {
        color: white;
      }
      .modal-dashboard .nav-tabs .nav-link.active {
        color: white;
      }
      .modal-dashboard .modal-header {
        padding: 2rem;
      }
      @media screen and (max-width: 420px) {
        .navbar-nav {
          display: inherit;
          flex-direction: inherit;
        }
        .nav-item  {
          display: inline-block;
          width: 48% !important;
          margin: 0rem .1rem;
        }
        .section-banner-img .nav-item{
          margin: 0rem !important;
        }
        .section-banner-img.section-img-loyalty .section-background-color {
          padding: 0rem 0rem 14rem 0rem !important;
        }
        .section-header-benefit .img-mockup {
          width: 95%;
        }
        .navbar-collapse {
          flex-basis: 100%;
          flex-grow: 1;
          align-items: center;
        }
      }
      @media screen and (max-width: 320px) {
        .point-history-inner h5 {
          font-size: .9rem;
        }
        .point-history-inner span {
          font-size: .7rem;
        }
      }
    </style>

    <?php include($prefix."include/footer.php"); ?>
    <?php include($prefix."include/script.php"); ?>

    <script>
      // Nav States
      $('#navReward').addClass('active');

      let brands = null;
      let globalBrand = null;

      $(function() {
        generateBrands();
        generateBenefits('SILVER');
      });
      // Animation on load
      document.addEventListener("DOMContentLoaded", function(event) {
        $(".loader").fadeOut('slow');
        $(".loader-wrapper").fadeOut("slow");
      //  $(".anim-1").addClass("animated fadeInLeft delayp10");
       // $(".anim-2").addClass("animated fadeInUp delayp12");
        //$(".anim-3").addClass("animated fadeInUp delayp14");  
      });

      const token = localStorage.getItem("tokenId");
      $('.img-medal').click(function(e){
        e.preventDefault();
        $('.img-medal').removeClass('active');
        $(this).addClass('active');
        const level = ($(this).data('level'));
        generateBenefits(level);
        generateBrands();
      });

      $(".button-brand-level").click(function (e) {
        e.preventDefault();
        const level = $(this).data("level");
        switchBrandDetail(globalBrand, level);
      });

      function generateBenefits(level) {
        $.ajax({
          url: apiUrl+ "promotion-level/?member_ship_code="+level,
          type: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/vnd.union+json; version=1.0',
            'Authorization': 'Bearer '+token
          },
          beforeSend: function () {
            $("#level-tier").empty();
            $("#brand-tier").empty();
            $("#medal-text").html(level);
          },
          complete: function(response) {
            if (response.responseJSON.meta.status) {
              const data = response.responseJSON.data;
              data.list.forEach(function(item, index){
                if (index == 0) {
                  $("#level-tier").append('<div class="col-md-6">'+
                                            '<div class="section-img-pattern-white pr-3 pl-3 py-4 mb-3 shadow-xs">'+
                                              '<div class="row">'+
                                                '<div class="col-3 col-md-3">'+
                                                  '<img src="'+item.icon+'" class="img-fluid" id="icon-level" alt="img brand">'+
                                                '</div>'+
                                                '<div class="col-8 col-md-8 container-content">'+
                                                  '<p class="nav-tab-description">'+item.name+'</p>'+
                                                '</div>'+
                                              '</div>'+
                                            '</div>'+
                                          '</div>');  
                }else {
                  $("#level-tier").append('<div class="col-md-6">'+
                                            '<a href="#" data-promo="'+item.id+'" data-level="'+level+'" data-type="'+item.promotion_type+'" data-icon="'+item.icon+'" data-name="'+item.name+'" class="button-promo" >'+
                                              '<div class="section-img-pattern-white pr-3 pl-3 py-4 mb-3 shadow-xs">'+
                                                '<div class="row">'+
                                                  '<div class="col-3 col-md-3">'+
                                                    '<img src="'+item.icon+'" class="img-fluid" id="icon-level" alt="img brand">'+
                                                  '</div>'+
                                                  '<div class="col-8 col-md-8 container-content">'+
                                                    '<p class="nav-tab-description">'+item.name+'</p>'+
                                                  '</div>'+
                                                  '<div class="col-1 container-content">'+
                                                    '<i class="fal fa-angle-right"></i>'+
                                                  '</div>'+
                                                '</div>'+
                                              '</div>'+
                                            '</a>'+
                                          '</div>');  
                }
              });
              brands.list.forEach(function(item, index) {
                $("#brand-tier").append(
                    '<div class="col-md-6">'+
                      '<a href="#" data-promo="'+item.id+'" data-type="'+item.promotion_type+'" data-level="'+level+'" class="button-brand">'+
                        '<div class="section-img-pattern-white nav-tab-brands pr-3 pl-3 py-4 mb-3 shadow-xs">'+
                          '<div class="row">'+
                            '<div class="col-3 col-md-3">'+
                              '<img src="'+item.logo_url+'" class="img-fluid" alt="img brand">'+
                            '</div>'+
                            '<div class="col-9 col-md-9 container-content">'+
                              '<div class="heading mb-0">'+
                                '<h6 class="text-gray-800">'+item.name+'</h6>'+
                              '</div>'+
                            '</div>'+
                          '</div>'+
                        '</div>'+
                      '</a>'+
                    '</div>'
                  )
              });

              $(".button-promo").click(function(e){
                e.preventDefault();
                const id = $(this).data("promo");
                const level = $(this).data("level");
                const type = $(this).data("type");
                $('#VocherLabel').html($(this).data("name"));
                $('#VocherIcon').attr("src",$(this).data("icon"));
                getPromoDetail(id, type, level);
              });

              $(".button-brand").click(function(e){
                e.preventDefault();
                const id = $(this).data("promo");
                const level = $(this).data("level");

                getBrandDetail(id, level);
              });
              
            }else {
              // alert(response.responseJSON.meta.message);
            }
          }
        });
      }

      // Brand

      function generateBrands() {
        $.ajax({
          url: apiUrl+ "brand/?page=1&limit=20",
          type: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/vnd.union+json; version=1.0',
            'Authorization': 'Bearer '+token
          },
          complete: function(response) {
            if (response.responseJSON.meta.status) {
              brands = response.responseJSON.data;
            }else {
              // alert(response.responseJSON.meta.message);
            }
          }
        });
      }


      function getPromoDetail(id, type, level) {
        $.ajax({
          url: apiUrl+ "promotion-level/"+id+"/?member_ship_code="+level+"&promotion_type="+type,
          type: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/vnd.union+json; version=1.0',
            'Authorization': 'Bearer '+token
          },
          beforeSend: function(){
            $('#modal-body-promo').empty();
          },
          complete: function(response) {
            if (response.responseJSON.meta.status) {
              const data = response.responseJSON.data;
              data.list.forEach(function(item, index){
                $('#modal-body-promo').append('<div class="point-history-row mb-4 mr-md-4 ml-md-4 mr-2 ml-2">'+
                                                '<div class="point-history-col pr-0 pl-0">'+
                                                  '<div class="row">'+
                                                    '<div class="col-12 col-md-12">'+
                                                      '<div class="point-history-img-merchant float-left mr-3">'+
                                                        '<img src="'+item.brand.logo_url+'" class="img-fluid" alt="Merchant">'+
                                                      '</div>'+
                                                      '<div class="point-history-inner float-left content-center">'+
                                                        '<p class="mb-0 mb-md-2">'+item.brand.name+'</p>'+
                                                        '<h5 class="mb-1 point-history-name-merchant">'+item.name+'</h5>'+
                                                        '<span>'+item.description+'</span>'+
                                                      '</div>'+
                                                    '</div>'+
                                                  '</div>'+
                                                '</div>'+
                                              '</div>');
              });
              $('#modal-promo').modal('show');
            }else {
              // alert(response.responseJSON.meta.message);
            }
          }
        });
      }

      function switchBrandDetail(id, level) {
        $.ajax({
          url: apiUrl+ "promotion-brand/?member_ship_code="+level+"&brand_id="+id,
          type: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/vnd.union+json; version=1.0',
            'Authorization': 'Bearer '+token
          },
          beforeSend: function(){
            $('#modal-body-brand-'+level.toLowerCase()).empty();
          },
          complete: function(response) {
            if (response.responseJSON.meta.status) {
              const data = response.responseJSON.data;
              console.log("data switch to "+level+" : ", data.list);
              data.list.forEach(function(item, index){
                if(item.name){
                  $('#modal-body-brand-'+level.toLowerCase()).append('<div class="border-bottom-dashed mt-4">'+
                                                  '<div class="heading">'+
                                                    '<h5 class="mb-0">'+item.name+'</h5>'+
                                                    '<p class="promotion">'+item.description+'</p>'+
                                                  '</div>'+
                                                '</div>');
                }
              });
            }else {
              // alert(response.responseJSON.meta.message);
            }
          }
        });
      }

      function getBrandDetail(id, level) {
        $.ajax({
          url: apiUrl+ "promotion-brand/?member_ship_code="+level+"&brand_id="+id,
          type: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/vnd.union+json; version=1.0',
            'Authorization': 'Bearer '+token
          },
          beforeSend: function(){
            $('#modal-body-brand-'+level.toLowerCase()).empty();
          },
          complete: function(response) {
            if (response.responseJSON.meta.status && response.responseJSON.data.list.length !==0) {
              const data = response.responseJSON.data;
              $('#modal-brand-logo').attr("src",data.list[0].brand.logo_url);
              $('#modal-brand-banner').attr("style", 'background: url('+data.list[0].brand.banner_url+'); background-size: cover;overflow: hidden;');
              $('#modal-brand-name').html(data.list[0].brand.name);
              $('.button-brand-level').attr("data-brand",data.list[0].brand.id);
              data.list.forEach(function(item, index){
                if(item.name){
                  $('#modal-body-brand-'+level.toLowerCase()).append('<div class="border-bottom-dashed mt-4">'+
                                                '<div class="heading">'+
                                                  '<h5 class="mb-0">'+item.name+'</h5>'+
                                                  '<p class="promotion">'+item.description+'</p>'+
                                                '</div>'+
                                              '</div>');
                }
              });
              
              
              $('#nav-'+level.toLowerCase()+'-tab').tab('show');
              $('#modal-brand').modal('show');

              globalBrand = id; 

            }else {
              // alert(response.responseJSON.meta.message);
            }
          }
        });
      }

    </script>
  </body>
</html>
